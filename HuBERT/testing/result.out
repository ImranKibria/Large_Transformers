2024-06-23 10:25:25.664854: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-06-23 10:25:25.664952: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-06-23 10:25:25.665827: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-06-23 10:25:25.670393: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-23 10:25:26.793227: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/users/PAS2301/kibria5/.conda/envs/vit_env/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/users/PAS2301/kibria5/.conda/envs/vit_env/lib/python3.9/site-packages/torch/nn/utils/weight_norm.py:28: UserWarning: torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.
  warnings.warn("torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.")
Availability of torch:  True
Device for model training & evaluation:  cuda

*** NISQA VAL SIM ***

*** NISQA VAL LIVE ***

*** NISQA TEST FOR ***

*** NISQA TEST P501 ***

*** NISQA TEST LIVETALK ***
HubertForSequenceClassification(
  (hubert): HubertModel(
    (feature_extractor): HubertFeatureEncoder(
      (conv_layers): ModuleList(
        (0): HubertGroupNormConvLayer(
          (conv): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
          (activation): GELUActivation()
          (layer_norm): GroupNorm(512, 512, eps=1e-05, affine=True)
        )
        (1-4): 4 x HubertNoLayerNormConvLayer(
          (conv): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
          (activation): GELUActivation()
        )
        (5-6): 2 x HubertNoLayerNormConvLayer(
          (conv): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
          (activation): GELUActivation()
        )
      )
    )
    (feature_projection): HubertFeatureProjection(
      (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (projection): Linear(in_features=512, out_features=768, bias=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): HubertEncoder(
      (pos_conv_embed): HubertPositionalConvEmbedding(
        (conv): Conv1d(768, 768, kernel_size=(128,), stride=(1,), padding=(64,), groups=16)
        (padding): HubertSamePadLayer()
        (activation): GELUActivation()
      )
      (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
      (layers): ModuleList(
        (0-11): 12 x HubertEncoderLayer(
          (attention): HubertAttention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): HubertFeedForward(
            (intermediate_dropout): Dropout(p=0.1, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
  )
  (projector): Linear(in_features=768, out_features=256, bias=True)
  (classifier): Linear(in_features=256, out_features=1, bias=True)
)

Testset under consideration:  NISQA_VAL_SIM
  0%|          | 0/40 [00:00<?, ?it/s]  5%|▌         | 2/40 [00:02<00:38,  1.02s/it]  8%|▊         | 3/40 [00:04<00:53,  1.45s/it] 10%|█         | 4/40 [00:06<01:00,  1.67s/it] 12%|█▎        | 5/40 [00:08<01:03,  1.80s/it] 15%|█▌        | 6/40 [00:10<01:04,  1.88s/it] 18%|█▊        | 7/40 [00:12<01:03,  1.94s/it] 20%|██        | 8/40 [00:14<01:03,  1.97s/it] 22%|██▎       | 9/40 [00:16<01:02,  2.00s/it] 25%|██▌       | 10/40 [00:18<01:00,  2.01s/it] 28%|██▊       | 11/40 [00:20<00:58,  2.03s/it] 30%|███       | 12/40 [00:22<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:25<00:59,  2.19s/it] 35%|███▌      | 14/40 [00:27<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:29<00:53,  2.13s/it] 40%|████      | 16/40 [00:31<00:53,  2.23s/it] 42%|████▎     | 17/40 [00:36<01:08,  2.96s/it] 45%|████▌     | 18/40 [00:38<00:59,  2.68s/it] 48%|████▊     | 19/40 [00:40<00:52,  2.49s/it] 50%|█████     | 20/40 [00:42<00:47,  2.36s/it] 52%|█████▎    | 21/40 [00:44<00:42,  2.26s/it] 55%|█████▌    | 22/40 [00:46<00:39,  2.20s/it] 57%|█████▊    | 23/40 [00:48<00:36,  2.15s/it] 60%|██████    | 24/40 [00:50<00:33,  2.12s/it] 62%|██████▎   | 25/40 [00:52<00:31,  2.10s/it] 65%|██████▌   | 26/40 [00:54<00:29,  2.09s/it] 68%|██████▊   | 27/40 [00:56<00:26,  2.08s/it] 70%|███████   | 28/40 [00:58<00:24,  2.07s/it] 72%|███████▎  | 29/40 [01:00<00:22,  2.07s/it] 75%|███████▌  | 30/40 [01:03<00:20,  2.06s/it] 78%|███████▊  | 31/40 [01:05<00:18,  2.06s/it] 80%|████████  | 32/40 [01:07<00:16,  2.07s/it] 82%|████████▎ | 33/40 [01:16<00:28,  4.13s/it] 85%|████████▌ | 34/40 [01:18<00:21,  3.50s/it] 88%|████████▊ | 35/40 [01:20<00:15,  3.07s/it] 90%|█████████ | 36/40 [01:22<00:11,  2.76s/it] 92%|█████████▎| 37/40 [01:24<00:07,  2.54s/it] 95%|█████████▌| 38/40 [01:26<00:04,  2.39s/it] 98%|█████████▊| 39/40 [01:28<00:02,  2.29s/it]100%|██████████| 40/40 [01:30<00:00,  2.19s/it]100%|██████████| 40/40 [01:36<00:00,  2.41s/it]
RMSE (utterance-level) =  0.48919345333424075
Pearson Correlation Coefficient =  0.921336836940393
Spearman Rank Correlation Coefficient =  0.920383426917748

Testset under consideration:  NISQA_VAL_LIVE
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:02<00:02,  1.02s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.44s/it]100%|██████████| 4/4 [00:06<00:00,  1.67s/it]100%|██████████| 4/4 [00:06<00:00,  1.68s/it]
RMSE (utterance-level) =  0.42200808721743477
Pearson Correlation Coefficient =  0.8659923933949217
Spearman Rank Correlation Coefficient =  0.8631171630715926

Testset under consideration:  NISQA_TEST_FOR
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:02<00:02,  1.02s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.45s/it]100%|██████████| 4/4 [00:06<00:00,  1.66s/it]100%|██████████| 4/4 [00:06<00:00,  1.69s/it]
RMSE (utterance-level) =  0.3910982888690285
Pearson Correlation Coefficient =  0.905712867916585
Spearman Rank Correlation Coefficient =  0.8953016226089134

Testset under consideration:  NISQA_TEST_P501
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:02<00:02,  1.02s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.45s/it]100%|██████████| 4/4 [00:06<00:00,  1.66s/it]100%|██████████| 4/4 [00:06<00:00,  1.69s/it]
RMSE (utterance-level) =  0.6219326328044587
Pearson Correlation Coefficient =  0.9241055602010889
Spearman Rank Correlation Coefficient =  0.9247238873416069

Testset under consideration:  NISQA_TEST_LIVETALK
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:02<00:02,  1.02s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.44s/it]100%|██████████| 4/4 [00:06<00:00,  1.65s/it]100%|██████████| 4/4 [00:06<00:00,  1.68s/it]
RMSE (utterance-level) =  0.5864690277136353
Pearson Correlation Coefficient =  0.7863863063523275
Spearman Rank Correlation Coefficient =  0.7572475476416204
